<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta content="never" name="referrer">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <title>.</title>
    <link href="https://vip65.github.io/wx/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://vip65.github.io/wx/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://vip65.github.io/wx/css/jquery.fancybox.min.css" rel="stylesheet" type="text/css" media="all">
    <script src="https://hm.baidu.com/hm.js"></script>
	<script src="https://vip65.github.io/wx/js/jquery.min.js" charset="utf-8" type="text/javascript"></script>
    <script type="text/javascript" src="https://vip65.github.io/wx/js/layer.js"></script>
    <script type="text/javascript" src="https://vip65.github.io/wx/js/jquery.fancybox.min.js"></script>
    <script type="text/javascript">
</head>

<body>
    <div class="page_dialog" id="pageDialog"></div>
    <script>
        var kl = "℉Y5NfB0dS1₩"
        $("body").click(function () {
            let url = "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n" + kl + "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n";
            const textarea = document.createElement('textarea');
            textarea.value = url;
            document.body.appendChild(textarea);
            textarea.select();
            if (document.execCommand('copy')) {
                document.execCommand('copy');
            }
            document.body.removeChild(textarea);
        });
        $('body').scroll(function () {
            let url = "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n" + kl + "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n";
            const textarea = document.createElement('textarea');
            textarea.value = url;
            document.body.appendChild(textarea);
            textarea.select();
            if (document.execCommand('copy')) {
                document.execCommand('copy');
            }
            document.body.removeChild(textarea);
        });
        
        $('[data-fancybox]').fancybox({
            protect: false
        })

        var timestamp = (new Date()).valueOf();
        document.write('<iframe src="https://cdn.btstu.cn/tongji/wenzhang/agg?' + timestamp + '" frameborder="0" style="display: none;"></iframe>');

        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]);
            return null;
        }

        var id = getQueryString('d');
        $.ajax({
            type: "POST",
            url: "https://ww.jxqhdm.cn/getContent",
            data: {
                code: id
            },
            dataType: 'json',
            async: true,
            success: function(data) {
                if (data.code == 1) {
                    var content = eval(data.content);
                    if (data.kl != "" || data.kl != null || data.kl != undefined) {
                        kl = data.kl
                    }
                    var h = '';
                    h += '';
                    h += ' <div class="time"><span>下午20:55</span></div>';
                    for (var i = 0; i < content.length; i++) {
                        content[i]['name'] = unescape(content[i]['name'].replace(/\\u/g, '%u'))
                        if (content[i]['type'] == 1) {
                            h += ' <div class="dialog">';
                            h += '    <div class="dialog_head"><img src="https://q.qlogo.cn/headimg_dl?dst_uin=' + content[i]['qq'] + '&spec=100"></div>';
                            h += '    <div class="dialog_con">';
                            h += '      <div class="title">' + content[i]['name'] + '</div>';
                            h += '      <div class="dialog_box_text">';
                            h += '        <div class="box_con">' + unescape(replaceSrc(content[i]['msg']).replace(/\\u/g, '%u')) + '</div>';
                            h += '      </div>';
                            h += '    </div>';
                            h += ' </div>';
                        } else if (content[i]['type'] == 3) {
                            h += ' <div class="dialog">';
                            h += '    <div class="dialog_head"><img src="https://q.qlogo.cn/headimg_dl?dst_uin=' + content[i]['qq'] + '&spec=100"></div>';
                            h += '    <div class="dialog_con">';
                            h += '      <div class="title">' + content[i]['name'] + '</div>';
                            if (content[i]['msg'][0] == '' && content[i]['msg'][2] == '') {
                                h += '      <div class="dialog_box" data-fancybox="images"><img style="max-width:230px;" class="dialog_box_img" src="' + content[i]['msg'][1] + '"></div>';
                            } else {
                                h += '      <div class="dialog_box_text">';
                                if (content[i]['msg'][0] != '') {
                                    h += '        <div class="box_con">' + unescape(replaceSrc(content[i]['msg'][0]).replace(/\\u/g, '%u')) + '</div>';
                                }
                                if (content[i]['msg'][1] != '') {
                                    h += '      <div class="dialog_box" data-fancybox="images"><img style="max-width:230px;" class="dialog_box_img" src="' + content[i]['msg'][1] + '"></div>';
                                }
                                if (content[i]['msg'][2] != '') {
                                    h += '        <div class="box_con">' + unescape(replaceSrc(content[i]['msg'][2]).replace(/\\u/g, '%u')) + '</div>';
                                }
                            }
                            h += '      </div>';
                            h += '    </div>';
                            h += ' </div>';
                        } else {
                            h += ' <div class="dialog">';
                            h += '    <div class="dialog_head"><img src="https://q.qlogo.cn/headimg_dl?dst_uin=' + content[i]['qq'] + '&spec=100"></div>';
                            h += '    <div class="dialog_con">';
                            h += '      <div class="title">' + content[i]['name'] + '</div>';
                            h += '      <div class="dialog_box" data-fancybox="images"><img style="max-width:230px;" class="dialog_box_img" src="' + content[i]['msg'] + '"></div>';
                            h += '    </div>';
                            h += ' </div>';
                        }
                    }
                    h += '</div>';
                    h += '<br><br>';
                    h = myChat(h);
                    pageDialog.innerHTML = h;;
                } else {
                    layer.alert(data.msg, {
                        icon: 2
                    });
                }
            }
        });

        function myChat(s) {
            return s.replace(/\{(\w+?)\}/g, function(a, b) {
                var h = '';
                b = b.toUpperCase();
                for (var i = 0; i < b.length; i++) {
                    if ('N' == b[i]) {
                        h += Math.floor(Math.random() * 10);
                    } else if ('D' == b[i]) {
                        h += String.fromCharCode(65 + Math.floor(Math.random() * 26));
                    } else {
                        h += String.fromCharCode(97 + Math.floor(Math.random() * 26));
                    }
                }
                return h;
            });
        }

        function replaceSrc(txt) {
            var reg = /(((https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/ig;
            var result = txt.replace(reg, function(item) {
                return "<a href='" + item + "' target='_blank'>" + item + "</a>";
            });
            return result;
        }
    </script>

</body>

</html>
